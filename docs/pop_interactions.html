<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.191">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Biomaths &amp; Python - Populations en interactions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Populations en interactions</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Biomaths &amp; Python</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Présentation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pop_isolees.html" class="sidebar-item-text sidebar-link">Populations isolées</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pop_exploitees.html" class="sidebar-item-text sidebar-link">Populations exploitées</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pop_interactions.html" class="sidebar-item-text sidebar-link active">Populations en interactions</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">A propos</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-lv" id="toc-sec-lv" class="nav-link active" data-scroll-target="#sec-lv">Le modèle proie-prédateur de Lotka et Volterra</a>
  <ul class="collapse">
  <li><a href="#dynamiques" id="toc-dynamiques" class="nav-link" data-scroll-target="#dynamiques">Dynamiques</a></li>
  <li><a href="#plan-de-phase" id="toc-plan-de-phase" class="nav-link" data-scroll-target="#plan-de-phase">Plan de phase</a></li>
  <li><a href="#intégrale-première" id="toc-intégrale-première" class="nav-link" data-scroll-target="#intégrale-première">Intégrale première</a></li>
  </ul></li>
  <li><a href="#sec-rma" id="toc-sec-rma" class="nav-link" data-scroll-target="#sec-rma">Le modèle de Rosenzweig MacArthur</a>
  <ul class="collapse">
  <li><a href="#dynamiques-et-plan-de-phase" id="toc-dynamiques-et-plan-de-phase" class="nav-link" data-scroll-target="#dynamiques-et-plan-de-phase">Dynamiques et plan de phase</a></li>
  <li><a href="#diagramme-de-bifurcations" id="toc-diagramme-de-bifurcations" class="nav-link" data-scroll-target="#diagramme-de-bifurcations">Diagramme de bifurcations</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/lmaillere/biomaths_www/edit/main/pop_interactions.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/lmaillere/biomaths_www/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Populations en interactions</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="sec-lv" class="level2">
<h2 class="anchored" data-anchor-id="sec-lv">Le modèle proie-prédateur de Lotka et Volterra</h2>
<p>Nous considérons le modèle de dynamique de populations de <span class="citation" data-cites="Lotka1925">Lotka (<a href="#ref-Lotka1925" role="doc-biblioref">1925</a>)</span> et <span class="citation" data-cites="Volterra1926">Volterra (<a href="#ref-Volterra1926" role="doc-biblioref">1926</a>)</span> :</p>
<p><span id="eq-lovo"><span class="math display">
\left\{\begin{array}{l}
\dot x = rx - c xy,\\
\dot y = bxy - m y.
\end{array}\right.
\tag{1}</span></span></p>
<section id="dynamiques" class="level3">
<h3 class="anchored" data-anchor-id="dynamiques">Dynamiques</h3>
<p>Il n’y a pas de difficulté particulière à la simulation par rapport au modèle de la tordeuse du bourgeon de l’épinette avec population d’oiseaux variables.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">## on nettoie l'espace de travail et on reload les modules</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>reset <span class="op">-</span>f</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">## densités initiales des populations</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>etat0_LV <span class="op">=</span> np.array([x0, y0])</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">## tspan</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>t_0 <span class="op">=</span> <span class="dv">0</span>             </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>t_fin <span class="op">=</span> <span class="fl">30.0</span>        </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>pas_t <span class="op">=</span> <span class="fl">0.01</span>        </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>tspan <span class="op">=</span> np.arange(t_0, t_fin, pas_t)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">## paramètres du modèle</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>params_LV <span class="op">=</span> np.array([r, c, b, m])</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">## définition du modèle de Lotka Volterra</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_LV(etat, t, params):</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat                       <span class="co"># recupere les variables d'etat</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    r, c, b, m <span class="op">=</span> params               <span class="co"># recupere les parametres </span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    etatdot <span class="op">=</span> [r<span class="op">*</span>x <span class="op">-</span> c<span class="op">*</span>x<span class="op">*</span>y,           <span class="co"># dot x</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>               b<span class="op">*</span>x<span class="op">*</span>y <span class="op">-</span> m<span class="op">*</span>y]           <span class="co"># dot y</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> etatdot                    <span class="co"># renvoie la derivee</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">## simulation proprement dite</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>int_LV <span class="op">=</span> odeint(model_LV, etat0_LV, tspan, args<span class="op">=</span>(params_LV,), hmax<span class="op">=</span>pas_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Représentation graphique contre le temps :</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">## création d'une figure, et d'un système d'axe</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fig1, ax1 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>fig1.suptitle(<span class="st">"Dynamiques Proies - Prédateurs modèle de Lotka Volterra"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>             va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé de x et y contre le temps</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ax1.plot(tspan, int_LV[:, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"proies $x$"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>ax1.plot(tspan, int_LV[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"prédateurs $y$"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">## axes &amp; co</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Temps'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Densités de populations'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-lovo-temps" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pop_interactions_files/figure-html/fig-lovo-temps-output-1.png" width="593" height="480" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: dynamiques des proies et prédateurs contre le temps dans le modèle de Lotka et Volterra (<a href="#eq-lovo">Equation&nbsp;1</a>)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plan-de-phase" class="level3">
<h3 class="anchored" data-anchor-id="plan-de-phase">Plan de phase</h3>
<p>Il est intéressant de représenter les trajectoires dans l’espace d’état <span class="math inline">(x,y)</span>, en combinaison avec une analyse qualitative du plan de phase (isoclines nulles, équilibres), une représentation du champs de vecteurs et de quelques morceaux de trajectoires sur le plan.</p>
<p>Commençons par calculer les isoclines nulles et les équilibres.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">## array annexes pour le calcul et la représentation des isoclines nulles</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>xplot <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">.1</span>)  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>yplot <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">.1</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">## isoclines nulles de xdot</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>null_x_x <span class="op">=</span> np.zeros_like(yplot)        <span class="co"># x = 0 isocline nulle de xdot</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>null_x_y <span class="op">=</span> np.ones_like(xplot)<span class="op">*</span>(r<span class="op">/</span>c)   <span class="co"># y = r/c isocline nulle de xdot</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">## isoclines nulles de ydot</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>null_y_y <span class="op">=</span> np.zeros_like(xplot)        <span class="co"># y = 0 isocline nulle de ydot</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>null_y_x <span class="op">=</span> np.ones_like(yplot)<span class="op">*</span>(m<span class="op">/</span>b)   <span class="co"># x = m/b isocline nulle de ydot</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">## équilibres</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>eq_extinct <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>eq_coex <span class="op">=</span> [r<span class="op">/</span>c, m<span class="op">/</span>b]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Puis on trace le plan de phase.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">## création d'une figure, et d'un système d'axe</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">## titre de la figure</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">"Dynamiques Proies - Prédateurs modèle de Lotka Volterra"</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">## isoclines nulles </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>ax2.plot(null_x_x, yplot, color <span class="op">=</span> <span class="st">'C2'</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ax2.plot(xplot, null_x_y, color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">"isoclines nulles de $\dot x$"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ax2.plot(xplot, null_y_y, color <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>ax2.plot(null_y_x, yplot, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"isoclines nulles de $\dot y$"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">## équilibres</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_extinct[<span class="dv">0</span>], eq_extinct[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C3'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_coex[<span class="dv">0</span>], eq_coex[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'C0'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">## trajectoires</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>ax2.plot(int_LV[:, <span class="dv">0</span>], int_LV[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"trajectoire"</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">## enluminures</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Proies $x$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Prédateurs $y$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>ax2.legend(fontsize<span class="op">=</span><span class="st">'10'</span>, loc <span class="op">=</span> <span class="st">"upper right"</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">## modification éventuelle des bornes des axes</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(bottom<span class="op">=-</span><span class="fl">.2</span>, top<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left<span class="op">=-</span><span class="fl">.2</span>, right<span class="op">=</span><span class="va">None</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-lovo-plane" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pop_interactions_files/figure-html/fig-lovo-plane-output-1.png" width="598" height="480" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: plan de phase du modèle proies-prédateurs de Lotka Volterra (<a href="#eq-lovo">Equation&nbsp;1</a>)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Complètons ce plan de phase avec l’orientation du champs de vecteurs (fonction <code>quiver</code>) et des échantillons de trajectoires (fonction <code>streamplot</code>). Ces représentations reposent sur la définition d’une grille de coordonnées sur le plan, via une <code>meshgrid</code>.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">## définition de l'échantillonnage selon $x$ et $y$</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x_grid <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, <span class="fl">3.0</span>, <span class="dv">10</span>)   <span class="co"># au passage on change un peu de np.arange()</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>y_grid <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, <span class="fl">3.0</span>, <span class="dv">10</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">## grille X,Y selon x_grid et y_grid</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x_grid, y_grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sur cette grille, on calcule les dérivées <span class="math inline">\dot x</span> et <span class="math inline">\dot y</span> :</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> model_LV([X, Y], <span class="dv">0</span>, params_LV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Et on peut compléter le plan de phase :</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé du champs de vecteur</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, width <span class="op">=</span> <span class="fl">.002</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé des échantillons de trajectoires</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>ax2.streamplot(X, Y, dx, dy, density <span class="op">=</span> <span class="fl">0.4</span>, maxlength <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="st">"purple"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>display(fig2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-lovo-plane-complet" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pop_interactions_files/figure-html/fig-lovo-plane-complet-output-1.png" width="598" height="480" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: plan de phase du modèle proies-prédateurs de Lotka Volterra</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Attention à l’option <code>angles ='xy'</code> de <code>quiver</code>: les flèches sont ainsi tracées avec orientation en unité naturelle de l’écran et pas en unité naturelle de la figure qui est le comportement par défaut de la méthode (qui n’est pas naturel).</p>
</div>
</div>
</section>
<section id="intégrale-première" class="level3">
<h3 class="anchored" data-anchor-id="intégrale-première">Intégrale première</h3>
<p>Finalement on peut représenter l’intégrale première de ce système. Commençons par la définir selon les calculs faits en cours :</p>
<p><span class="math display">
H(x,y) = -r\log(y)+ c y - m \log(x) + b x.
</span></p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> int_premiere(etat, params):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat                       </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    r, c, b, m <span class="op">=</span> params               </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    H_xy <span class="op">=</span> <span class="op">-</span>r<span class="op">*</span>np.log(y) <span class="op">+</span> c<span class="op">*</span>y <span class="op">-</span> m<span class="op">*</span>np.log(x) <span class="op">+</span> b<span class="op">*</span>x  </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> H_xy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Effectuons une représentation graphique en 3D dans l’espace <span class="math inline">(x, y, H)</span>, ce qui fournit un visuel intéressant.</p>
<p>Pour celà nous avons besoin d’une <code>meshgrid</code> plus précise que celle définie plus haut.</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x_grid <span class="op">=</span> np.linspace(<span class="fl">0.15</span>, <span class="fl">3.0</span>, <span class="dv">30</span>)   </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>y_grid <span class="op">=</span> np.linspace(<span class="fl">0.15</span>, <span class="fl">3.0</span>, <span class="dv">30</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x_grid, y_grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fig3, ax3 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, subplot_kw<span class="op">=</span>{<span class="st">"projection"</span>: <span class="st">"3d"</span>})  </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">## colormaps</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">## intégrale première sur la grille X, Y</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>ax3.plot_surface(X, Y, int_premiere([X, Y], params_LV),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>             cmap<span class="op">=</span>cm.viridis, antialiased<span class="op">=</span><span class="va">True</span>, alpha <span class="op">=</span><span class="fl">.7</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">## réglage de l'angle de vision en fonction de l'élévation et de l'azimut</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>ax3.view_init(elev<span class="op">=</span><span class="dv">10</span>, azim<span class="op">=</span> <span class="dv">30</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">## labellisation des axes</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Proies $x$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Prédateurs $y$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>ax3.set_zlabel(<span class="st">'Intégrale première'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>ax3.set_yticklabels([])</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>ax3.set_xticklabels([])</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>ax3.set_zticklabels([])</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>fig3.suptitle(<span class="st">"Intégrale première</span><span class="ch">\n</span><span class="st"> modèle de Lotka Volterra"</span>, </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-int-prem" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pop_interactions_files/figure-html/fig-int-prem-output-1.png" width="393" height="437" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: intégrale première du modèle proies prédateurs de Lotka Volterra (<a href="#eq-lovo">Equation&nbsp;1</a>)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>On rajoute la trajectoire et la valeur <span class="math inline">H(x,y) = H(x_0, y_0)</span> :</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">## H(x,y) = H(x0,y0)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ax3.plot_surface(X, Y, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                np.ones_like(X)<span class="op">*</span>int_premiere([x0, y0], params_LV), </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                antialiased<span class="op">=</span><span class="va">True</span>, alpha <span class="op">=</span><span class="fl">.3</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">## trajectoire</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>ax3.plot(int_LV[:,<span class="dv">0</span>], int_LV[:,<span class="dv">1</span>], </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>         int_premiere([int_LV[:,<span class="dv">0</span>], int_LV[:,<span class="dv">1</span>]], params_LV), </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>         color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>display(fig3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-int-prem-full" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pop_interactions_files/figure-html/fig-int-prem-full-output-1.png" width="393" height="437" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: intégrale première du modèle proies prédateurs de Lotka Volterra (<a href="#eq-lovo">Equation&nbsp;1</a>)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-rma" class="level2">
<h2 class="anchored" data-anchor-id="sec-rma">Le modèle de Rosenzweig MacArthur</h2>
<p>Nous considérons le modèle de dynamique de populations attribué à Rosenzweig et MacArthur (voir <span class="citation" data-cites="Rosenzweig1963">Rosenzweig and MacArthur (<a href="#ref-Rosenzweig1963" role="doc-biblioref">1963</a>)</span>, <span class="citation" data-cites="Turchin2003">Turchin (<a href="#ref-Turchin2003" role="doc-biblioref">2003</a>)</span>, <span class="citation" data-cites="Smith2008">Smith (<a href="#ref-Smith2008" role="doc-biblioref">2008</a>)</span>).</p>
<p><span id="eq-rma"><span class="math display">
\left\{\begin{array}{l}
\dot x = \displaystyle rx\left(1-\frac{x}{K}\right) - c \frac{x}{h+x} y\\[.3cm]
\dot y = b\displaystyle \frac{x}{h+x} y - m y
\end{array}\right.
\tag{2}</span></span></p>
<section id="dynamiques-et-plan-de-phase" class="level3">
<h3 class="anchored" data-anchor-id="dynamiques-et-plan-de-phase">Dynamiques et plan de phase</h3>
<p>Il n’y a pas de difficulté particulière à la simulation par rapport au modèle de Lotka Volterra.</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>reset <span class="op">-</span>f</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">## densités initiales des populations</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>etat0_RMA <span class="op">=</span> np.array([x0, y0])</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">## tspan </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>t_0 <span class="op">=</span> <span class="dv">0</span>             </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>t_fin <span class="op">=</span> <span class="fl">80.0</span>        </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>pas_t <span class="op">=</span> <span class="fl">0.01</span>         </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>tspan <span class="op">=</span> np.arange(t_0, t_fin, pas_t)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">## paramètres (il y a un cycle limite attractif pour ces valeurs)</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="fl">2.0</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">2.0</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>params_RMA <span class="op">=</span> np.array([r, K, c, h, b, m])</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co">## modèle </span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_RMA(etat, t, params):</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat                               </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    r, K, c, h, b, m <span class="op">=</span> params               </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    etatdot <span class="op">=</span> [r<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>K) <span class="op">-</span> c<span class="op">*</span>x<span class="op">/</span>(h<span class="op">+</span>x)<span class="op">*</span>y,   </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>               b<span class="op">*</span>x<span class="op">/</span>(h<span class="op">+</span>x)<span class="op">*</span>y <span class="op">-</span> m<span class="op">*</span>y]       </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> etatdot                     </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co">## simulation </span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>int_RMA <span class="op">=</span> odeint(model_RMA, etat0_RMA, tspan, args<span class="op">=</span>(params_RMA,), hmax<span class="op">=</span>pas_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Représentation graphique des trajectoires contre le temps :</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig1, ax1 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig1.suptitle(<span class="st">"Dynamiques du modèle de Rosenzweig - MacArthur"</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé de x et y contre le temps</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>ax1.plot(tspan, int_RMA[:, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"proies $x$"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>ax1.plot(tspan, int_RMA[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"prédateurs $y$"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">## enluminures</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'temps'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'densités de populations'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>ax1.legend(fontsize<span class="op">=</span><span class="st">'10'</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rma-temps" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pop_interactions_files/figure-html/fig-rma-temps-output-1.png" width="588" height="480" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6: simulation des trajectoires du modèle de Rosenzweig et MacArthur (<a href="#eq-rma">Equation&nbsp;2</a>)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Représentation graphique dans le plan de phase :</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">"Plan de phase du modèle de Rosenzweig - MacArthur"</span>, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">## calcul des isoclines nulles</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>xplot <span class="op">=</span> np.arange(<span class="dv">0</span>, K<span class="op">+</span><span class="fl">.1</span>, <span class="fl">.1</span>)  </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>yplot <span class="op">=</span> np.arange(<span class="dv">0</span>, K<span class="op">+</span><span class="fl">.1</span>, <span class="fl">.1</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>null_x_x <span class="op">=</span> np.zeros_like(yplot)        </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>null_x_y <span class="op">=</span> r<span class="op">/</span>c<span class="op">*</span>(h<span class="op">+</span>xplot)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>xplot<span class="op">/</span>K)   </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>null_y_y <span class="op">=</span> np.zeros_like(xplot)        </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>null_y_x <span class="op">=</span> np.ones_like(yplot)<span class="op">*</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">## équilibres</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>eq_extinct <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>eq_coex <span class="op">=</span> [m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m), r<span class="op">/</span>c<span class="op">*</span>(h<span class="op">+</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m))<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">/</span>K)]</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>eq_prey <span class="op">=</span> [K, <span class="dv">0</span>]</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé des isoclines nulles, des équilibres, et de la trajectoire simulée</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>ax2.plot(null_x_x, yplot, color <span class="op">=</span> <span class="st">'C2'</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>ax2.plot(xplot, null_x_y, color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">"isoclines nulles de $\dot x$"</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>ax2.plot(xplot, null_y_y, color <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>ax2.plot(null_y_x, yplot, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"isoclines nulles de $\dot y$"</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">## équilibres</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_extinct[<span class="dv">0</span>], eq_extinct[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C3'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_coex[<span class="dv">0</span>], eq_coex[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C3'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_prey[<span class="dv">0</span>], eq_prey[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C3'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">## trajectoires</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>ax2.plot(int_RMA[:, <span class="dv">0</span>], int_RMA[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"trajectoire"</span>)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">## enluminures</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Proies $x$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Prédateurs $y$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>ax2.legend(fontsize<span class="op">=</span><span class="st">'10'</span>, loc <span class="op">=</span> <span class="st">"upper right"</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(bottom<span class="op">=-</span><span class="dv">2</span>, top<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left<span class="op">=-</span><span class="dv">2</span>, right<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">## représentation du champs de vecteurs</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>x_grid <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, K, <span class="dv">10</span>)   </span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>y_grid <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, K, <span class="dv">10</span>)</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x_grid, y_grid)</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co">## dérivées dot_x et dot_y sur la grille</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> model_RMA([X, Y], <span class="dv">0</span>, params_RMA)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, width <span class="op">=</span> <span class="fl">.002</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rma-plane" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pop_interactions_files/figure-html/fig-rma-plane-output-1.png" width="593" height="480" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;7: plan de phase du modèle de Rosenzweig et MacArthur (<a href="#eq-rma">Equation&nbsp;2</a>)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="diagramme-de-bifurcations" class="level3">
<h3 class="anchored" data-anchor-id="diagramme-de-bifurcations">Diagramme de bifurcations</h3>
<p>Nous allons représenter les asymptotiques de la population de prédateurs <span class="math inline">y^*</span> en fonction de <span class="math inline">K</span>. Il y a 3 situations asymptotiques distinctes pour le modèle de Rosenzweig MacArthur :</p>
<ul>
<li><p>si : <span class="math inline">0&lt;K&lt;\displaystyle\frac{mh}{b-m}</span> : les prédateurs s’éteignent et les proies convergent vers <span class="math inline">K</span>, l’équilibre d’extinction des deux populations est instable.</p></li>
<li><p>si : <span class="math inline">\displaystyle\frac{mh}{b-m} &lt;K&lt; h+\frac{2mh}{b-m}</span> : proies et prédateurs co-existent à un équilibre globalement asymptotiquement stable, l’équilibre d’extinction des prédateurs est instable, l’équilibre d’extinction des deux populations est instable.</p></li>
<li><p>si : <span class="math inline">h+\displaystyle\frac{2mh}{b-m}&lt;K</span> proies et prédateurs co-existent le long d’un cycle limite globalement asymptotiquement stable, l’équilibre d’extinction des prédateurs est instable, l’équilibre d’extinction des deux populations est instable.</p></li>
</ul>
<p>Dans un premier temps nous allons calculer et représenter les différents équilibres et leur stabilité dans le plan <span class="math inline">(K, y)</span>, puis nous calculerons et rajouterons une représentation du cycle limite.</p>
<p>Commençons par les équilibres :</p>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pas_K <span class="op">=</span> <span class="fl">.1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 1. </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>Kplot1 <span class="op">=</span> np.arange(pas_K, m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">+</span>pas_K, pas_K) </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>y_prey1 <span class="op">=</span> np.zeros_like(Kplot1)                    </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 2.</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>Kplot2 <span class="op">=</span> np.arange(m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m), h<span class="op">+</span><span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">+</span>pas_K, pas_K)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>y_prey2 <span class="op">=</span> np.zeros_like(Kplot2)                    </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>y_coex2 <span class="op">=</span> [r<span class="op">/</span>c<span class="op">*</span>(h<span class="op">+</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m))<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">/</span>K_p) <span class="cf">for</span> K_p <span class="kw">in</span> Kplot2]</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 3.</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>Kplot3 <span class="op">=</span> np.arange(h<span class="op">+</span><span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m), <span class="dv">8</span>, pas_K<span class="op">/</span><span class="dv">2</span>)      </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>y_prey3 <span class="op">=</span> np.zeros_like(Kplot3)                    </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>y_coex3 <span class="op">=</span> [r<span class="op">/</span>c<span class="op">*</span>(h<span class="op">+</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m))<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">/</span>K_p) <span class="cf">for</span> K_p <span class="kw">in</span> Kplot3]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Représentation graphique :</p>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fig3, ax3 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fig3.suptitle(<span class="st">"Diagramme de bifurcations $y^*$ en fonction de $K$"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>             va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé des différentes branches d'équilibres</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 1.</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot1, y_prey1, color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">"équilibre stable"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 2.</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot2, y_prey2, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"équilibre instable"</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot2, y_coex2, color <span class="op">=</span> <span class="st">'C2'</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 3.</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot3, y_prey3, color <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot3, y_coex3, color <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">## enluminures</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'densité de prédateurs $y_\infty$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'capacité de charge $K$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">## Type des bifurcations</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">2.2</span>, <span class="fl">0.1</span>, <span class="st">'transcritique'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">5.15</span>, <span class="fl">2.75</span>, <span class="st">'Hopf'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>ax3.grid()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-bif-rma" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pop_interactions_files/figure-html/fig-bif-rma-output-1.png" width="594" height="483" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8: diagramme de bifurcation <span class="math inline">y^*</span> en fonction de <span class="math inline">K</span> pour le modèle de Rosenzweig MacArthur (<a href="#eq-rma">Equation&nbsp;2</a>)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>On aimerait pouvoir visualiser sur le diagramme de bifurcations l’amplitude du cycle limite attractif qui émerge de l’équilibre instable. Pour cela, on utilise une approche qui consiste à simuler pendant longtemps le système dynamique et récupérer les extrema de la trajectoire périodique pour ensuite les tracer (approche “brute force”).</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">## temps d'intégration du transitoire "long"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tspan_transitoire <span class="op">=</span> np.arange(t_0, <span class="dv">100</span><span class="op">*</span>t_fin, pas_t)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">## array pour sauvegarder les extrema de la trajectoire périodique</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>y_cycle_min <span class="op">=</span> np.array([])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>y_cycle_max <span class="op">=</span> np.array([])</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> K_p <span class="kw">in</span> Kplot3:</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">## on assigne le paramètre K à la valeur K_p</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    params_RMA_cycle <span class="op">=</span> np.array([r, K_p, c, h, b, m])</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">## on simule le système pendant le transitoire</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    int_RMA_transitoire <span class="op">=</span>  odeint(model_RMA, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>            etat0_RMA, tspan_transitoire, args<span class="op">=</span>(params_RMA_cycle,), </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>            hmax<span class="op">=</span>pas_t)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">## on resimule depuis la dernière valeur calculée </span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">## dans la simulation du transitoire</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    int_RMA_cycle <span class="op">=</span> odeint(model_RMA, int_RMA_transitoire[<span class="op">-</span><span class="dv">1</span>, :], </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>            tspan, args<span class="op">=</span>(params_RMA_cycle,), hmax<span class="op">=</span>pas_t)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">## on sauvegarde les extremas dans y_cycle_min et </span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">## _max en appendant les array et les réassignant</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    y_cycle_min <span class="op">=</span> np.append(y_cycle_min, np.<span class="bu">min</span>(int_RMA_cycle[:,<span class="dv">1</span>]))</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    y_cycle_max <span class="op">=</span> np.append(y_cycle_max, np.<span class="bu">max</span>(int_RMA_cycle[:,<span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il ne reste plus qu’à tracer ces branches correspondant au cycle limite.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot3, y_cycle_min, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"cycle limite attractif"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot3, y_cycle_max, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">## légende</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>ax3.legend(fontsize<span class="op">=</span><span class="st">'10'</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">## réafficher la figure</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>display(fig3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-bif-rma-full" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pop_interactions_files/figure-html/fig-bif-rma-full-output-1.png" width="582" height="483" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;9: diagramme de bifurcation <span class="math inline">y^*</span> en fonction de <span class="math inline">K</span> pour le modèle de Rosenzweig MacArthur (<a href="#eq-rma">Equation&nbsp;2</a>)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>That’s all folks!</p>


<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Lotka1925" class="csl-entry" role="doc-biblioentry">
Lotka, A. J. 1925. <em>Elements of Physical Biology</em>. Williams; Wilkins.
</div>
<div id="ref-Rosenzweig1963" class="csl-entry" role="doc-biblioentry">
Rosenzweig, M. L., and R. H. MacArthur. 1963. <span>“Graphical Representation and Stability Conditions of Predator-Prey Interactions.”</span> <em>American Naturalist</em> 97: 209–23.
</div>
<div id="ref-Smith2008" class="csl-entry" role="doc-biblioentry">
Smith, H. L. 2008. <span>“The Rosenzweig MacArthur Predator Prey Model.”</span>
</div>
<div id="ref-Turchin2003" class="csl-entry" role="doc-biblioentry">
Turchin, P. 2003. <em>Complex Population Dynamics</em>. Princeton University Press.
</div>
<div id="ref-Volterra1926" class="csl-entry" role="doc-biblioentry">
Volterra, V. 1926. <span>“Variazioni e Fluttuazioni Del Numero d’individui in Specie Animali Conviventi.”</span> <em>Memoria Della Reale Accademia Nazionale Dei Lincei</em> 2: 31–113.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb19" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Populations en interactions"</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Le modèle proie-prédateur de Lotka et Volterra {#sec-lv}</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>Nous considérons le modèle de dynamique de populations de @Lotka1925 et @Volterra1926 :</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>\dot x = rx - c xy,<span class="sc">\\</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>\dot y = bxy - m y.</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>$$ {#eq-lovo}</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dynamiques</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>Il n'y a pas de difficulté particulière à la simulation par rapport au modèle de la tordeuse du bourgeon de l'épinette avec population d'oiseaux variables.</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co">## on nettoie l'espace de travail et on reload les modules</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>reset <span class="op">-</span>f</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="co">## densités initiales des populations</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>etat0_LV <span class="op">=</span> np.array([x0, y0])</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="co">## tspan</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>t_0 <span class="op">=</span> <span class="dv">0</span>             </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>t_fin <span class="op">=</span> <span class="fl">30.0</span>        </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>pas_t <span class="op">=</span> <span class="fl">0.01</span>        </span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>tspan <span class="op">=</span> np.arange(t_0, t_fin, pas_t)</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="co">## paramètres du modèle</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>params_LV <span class="op">=</span> np.array([r, c, b, m])</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="co">## définition du modèle de Lotka Volterra</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_LV(etat, t, params):</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat                       <span class="co"># recupere les variables d'etat</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>    r, c, b, m <span class="op">=</span> params               <span class="co"># recupere les parametres </span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>    etatdot <span class="op">=</span> [r<span class="op">*</span>x <span class="op">-</span> c<span class="op">*</span>x<span class="op">*</span>y,           <span class="co"># dot x</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>               b<span class="op">*</span>x<span class="op">*</span>y <span class="op">-</span> m<span class="op">*</span>y]           <span class="co"># dot y</span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> etatdot                    <span class="co"># renvoie la derivee</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a><span class="co">## simulation proprement dite</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>int_LV <span class="op">=</span> odeint(model_LV, etat0_LV, tspan, args<span class="op">=</span>(params_LV,), hmax<span class="op">=</span>pas_t)</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>Représentation graphique contre le temps :</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lovo-temps</span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: dynamiques des proies et prédateurs contre le temps dans le modèle de Lotka et Volterra (@eq-lovo)</span></span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a><span class="co">## création d'une figure, et d'un système d'axe</span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>fig1, ax1 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>fig1.suptitle(<span class="st">"Dynamiques Proies - Prédateurs modèle de Lotka Volterra"</span>,</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>             va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé de x et y contre le temps</span></span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>ax1.plot(tspan, int_LV[:, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"proies $x$"</span>)</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>ax1.plot(tspan, int_LV[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"prédateurs $y$"</span>)</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a><span class="co">## axes &amp; co</span></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Temps'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Densités de populations'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plan de phase</span></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>Il est intéressant de représenter les trajectoires dans l'espace d'état $(x,y)$, en combinaison avec une analyse qualitative du plan de phase (isoclines nulles, équilibres), une représentation du champs de vecteurs et de quelques morceaux de trajectoires sur le plan.</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>Commençons par calculer les isoclines nulles et les équilibres.</span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a><span class="co">## array annexes pour le calcul et la représentation des isoclines nulles</span></span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>xplot <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">.1</span>)  </span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a>yplot <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">.1</span>)</span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a><span class="co">## isoclines nulles de xdot</span></span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>null_x_x <span class="op">=</span> np.zeros_like(yplot)        <span class="co"># x = 0 isocline nulle de xdot</span></span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>null_x_y <span class="op">=</span> np.ones_like(xplot)<span class="op">*</span>(r<span class="op">/</span>c)   <span class="co"># y = r/c isocline nulle de xdot</span></span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a><span class="co">## isoclines nulles de ydot</span></span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a>null_y_y <span class="op">=</span> np.zeros_like(xplot)        <span class="co"># y = 0 isocline nulle de ydot</span></span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a>null_y_x <span class="op">=</span> np.ones_like(yplot)<span class="op">*</span>(m<span class="op">/</span>b)   <span class="co"># x = m/b isocline nulle de ydot</span></span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a><span class="co">## équilibres</span></span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a>eq_extinct <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>eq_coex <span class="op">=</span> [r<span class="op">/</span>c, m<span class="op">/</span>b]</span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a>Puis on trace le plan de phase.</span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lovo-plane</span></span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: plan de phase du modèle proies-prédateurs de Lotka Volterra (@eq-lovo)</span></span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a><span class="co">## création d'une figure, et d'un système d'axe</span></span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a><span class="co">## titre de la figure</span></span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">"Dynamiques Proies - Prédateurs modèle de Lotka Volterra"</span>, </span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a><span class="co">## isoclines nulles </span></span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a>ax2.plot(null_x_x, yplot, color <span class="op">=</span> <span class="st">'C2'</span>)</span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a>ax2.plot(xplot, null_x_y, color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">"isoclines nulles de $\dot x$"</span>)</span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a>ax2.plot(xplot, null_y_y, color <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a>ax2.plot(null_y_x, yplot, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"isoclines nulles de $\dot y$"</span>)</span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a><span class="co">## équilibres</span></span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_extinct[<span class="dv">0</span>], eq_extinct[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C3'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_coex[<span class="dv">0</span>], eq_coex[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, </span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'C0'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a><span class="co">## trajectoires</span></span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a>ax2.plot(int_LV[:, <span class="dv">0</span>], int_LV[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"trajectoire"</span>)</span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a><span class="co">## enluminures</span></span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Proies $x$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Prédateurs $y$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a>ax2.legend(fontsize<span class="op">=</span><span class="st">'10'</span>, loc <span class="op">=</span> <span class="st">"upper right"</span>)</span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a><span class="co">## modification éventuelle des bornes des axes</span></span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(bottom<span class="op">=-</span><span class="fl">.2</span>, top<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left<span class="op">=-</span><span class="fl">.2</span>, right<span class="op">=</span><span class="va">None</span>)<span class="op">;</span></span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-153"><a href="#cb19-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-154"><a href="#cb19-154" aria-hidden="true" tabindex="-1"></a>Complètons ce plan de phase avec l'orientation du champs de vecteurs (fonction <span class="in">`quiver`</span>) et des échantillons de trajectoires (fonction <span class="in">`streamplot`</span>). Ces représentations reposent sur la définition d'une grille de coordonnées sur le plan, via une <span class="in">`meshgrid`</span>.</span>
<span id="cb19-155"><a href="#cb19-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-158"><a href="#cb19-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-159"><a href="#cb19-159" aria-hidden="true" tabindex="-1"></a><span class="co">## définition de l'échantillonnage selon $x$ et $y$</span></span>
<span id="cb19-160"><a href="#cb19-160" aria-hidden="true" tabindex="-1"></a>x_grid <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, <span class="fl">3.0</span>, <span class="dv">10</span>)   <span class="co"># au passage on change un peu de np.arange()</span></span>
<span id="cb19-161"><a href="#cb19-161" aria-hidden="true" tabindex="-1"></a>y_grid <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, <span class="fl">3.0</span>, <span class="dv">10</span>)</span>
<span id="cb19-162"><a href="#cb19-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-163"><a href="#cb19-163" aria-hidden="true" tabindex="-1"></a><span class="co">## grille X,Y selon x_grid et y_grid</span></span>
<span id="cb19-164"><a href="#cb19-164" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x_grid, y_grid)</span>
<span id="cb19-165"><a href="#cb19-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-166"><a href="#cb19-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-167"><a href="#cb19-167" aria-hidden="true" tabindex="-1"></a>Sur cette grille, on calcule les dérivées $\dot x$ et $\dot y$ :</span>
<span id="cb19-168"><a href="#cb19-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-171"><a href="#cb19-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-172"><a href="#cb19-172" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> model_LV([X, Y], <span class="dv">0</span>, params_LV)</span>
<span id="cb19-173"><a href="#cb19-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-174"><a href="#cb19-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-175"><a href="#cb19-175" aria-hidden="true" tabindex="-1"></a>Et on peut compléter le plan de phase :</span>
<span id="cb19-176"><a href="#cb19-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-179"><a href="#cb19-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-180"><a href="#cb19-180" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lovo-plane-complet</span></span>
<span id="cb19-181"><a href="#cb19-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: plan de phase du modèle proies-prédateurs de Lotka Volterra </span></span>
<span id="cb19-182"><a href="#cb19-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-183"><a href="#cb19-183" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé du champs de vecteur</span></span>
<span id="cb19-184"><a href="#cb19-184" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, width <span class="op">=</span> <span class="fl">.002</span>)</span>
<span id="cb19-185"><a href="#cb19-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-186"><a href="#cb19-186" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé des échantillons de trajectoires</span></span>
<span id="cb19-187"><a href="#cb19-187" aria-hidden="true" tabindex="-1"></a>ax2.streamplot(X, Y, dx, dy, density <span class="op">=</span> <span class="fl">0.4</span>, maxlength <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="st">"purple"</span>)</span>
<span id="cb19-188"><a href="#cb19-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-189"><a href="#cb19-189" aria-hidden="true" tabindex="-1"></a>display(fig2)</span>
<span id="cb19-190"><a href="#cb19-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-191"><a href="#cb19-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-192"><a href="#cb19-192" aria-hidden="true" tabindex="-1"></a>:::{.callout-important}</span>
<span id="cb19-193"><a href="#cb19-193" aria-hidden="true" tabindex="-1"></a>Attention à l'option <span class="in">`angles ='xy'`</span> de <span class="in">`quiver`</span>: les flèches sont ainsi tracées avec orientation en unité naturelle de l'écran et pas en unité naturelle de la figure qui est le comportement par défaut de la méthode (qui n'est pas naturel).</span>
<span id="cb19-194"><a href="#cb19-194" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-195"><a href="#cb19-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-196"><a href="#cb19-196" aria-hidden="true" tabindex="-1"></a><span class="fu">### Intégrale première</span></span>
<span id="cb19-197"><a href="#cb19-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-198"><a href="#cb19-198" aria-hidden="true" tabindex="-1"></a>Finalement on peut représenter l'intégrale première de ce système. Commençons par la définir selon les calculs faits en cours :</span>
<span id="cb19-199"><a href="#cb19-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-200"><a href="#cb19-200" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb19-201"><a href="#cb19-201" aria-hidden="true" tabindex="-1"></a>H(x,y) = -r\log(y)+ c y - m \log(x) + b x.</span>
<span id="cb19-202"><a href="#cb19-202" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb19-203"><a href="#cb19-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-206"><a href="#cb19-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-207"><a href="#cb19-207" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> int_premiere(etat, params):</span>
<span id="cb19-208"><a href="#cb19-208" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat                       </span>
<span id="cb19-209"><a href="#cb19-209" aria-hidden="true" tabindex="-1"></a>    r, c, b, m <span class="op">=</span> params               </span>
<span id="cb19-210"><a href="#cb19-210" aria-hidden="true" tabindex="-1"></a>    H_xy <span class="op">=</span> <span class="op">-</span>r<span class="op">*</span>np.log(y) <span class="op">+</span> c<span class="op">*</span>y <span class="op">-</span> m<span class="op">*</span>np.log(x) <span class="op">+</span> b<span class="op">*</span>x  </span>
<span id="cb19-211"><a href="#cb19-211" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> H_xy</span>
<span id="cb19-212"><a href="#cb19-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-213"><a href="#cb19-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-214"><a href="#cb19-214" aria-hidden="true" tabindex="-1"></a>Effectuons une représentation graphique en 3D dans l'espace $(x, y, H)$, ce qui fournit un visuel intéressant.</span>
<span id="cb19-215"><a href="#cb19-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-216"><a href="#cb19-216" aria-hidden="true" tabindex="-1"></a>Pour celà nous avons besoin d'une <span class="in">`meshgrid`</span> plus précise que celle définie plus haut.</span>
<span id="cb19-217"><a href="#cb19-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-220"><a href="#cb19-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-221"><a href="#cb19-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-222"><a href="#cb19-222" aria-hidden="true" tabindex="-1"></a>x_grid <span class="op">=</span> np.linspace(<span class="fl">0.15</span>, <span class="fl">3.0</span>, <span class="dv">30</span>)   </span>
<span id="cb19-223"><a href="#cb19-223" aria-hidden="true" tabindex="-1"></a>y_grid <span class="op">=</span> np.linspace(<span class="fl">0.15</span>, <span class="fl">3.0</span>, <span class="dv">30</span>)</span>
<span id="cb19-224"><a href="#cb19-224" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x_grid, y_grid)</span>
<span id="cb19-225"><a href="#cb19-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-226"><a href="#cb19-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-229"><a href="#cb19-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-230"><a href="#cb19-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-int-prem</span></span>
<span id="cb19-231"><a href="#cb19-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: intégrale première du modèle proies prédateurs de Lotka Volterra (@eq-lovo)</span></span>
<span id="cb19-232"><a href="#cb19-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-233"><a href="#cb19-233" aria-hidden="true" tabindex="-1"></a>fig3, ax3 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, subplot_kw<span class="op">=</span>{<span class="st">"projection"</span>: <span class="st">"3d"</span>})  </span>
<span id="cb19-234"><a href="#cb19-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-235"><a href="#cb19-235" aria-hidden="true" tabindex="-1"></a><span class="co">## colormaps</span></span>
<span id="cb19-236"><a href="#cb19-236" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span>
<span id="cb19-237"><a href="#cb19-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-238"><a href="#cb19-238" aria-hidden="true" tabindex="-1"></a><span class="co">## intégrale première sur la grille X, Y</span></span>
<span id="cb19-239"><a href="#cb19-239" aria-hidden="true" tabindex="-1"></a>ax3.plot_surface(X, Y, int_premiere([X, Y], params_LV),</span>
<span id="cb19-240"><a href="#cb19-240" aria-hidden="true" tabindex="-1"></a>             cmap<span class="op">=</span>cm.viridis, antialiased<span class="op">=</span><span class="va">True</span>, alpha <span class="op">=</span><span class="fl">.7</span>)</span>
<span id="cb19-241"><a href="#cb19-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-242"><a href="#cb19-242" aria-hidden="true" tabindex="-1"></a><span class="co">## réglage de l'angle de vision en fonction de l'élévation et de l'azimut</span></span>
<span id="cb19-243"><a href="#cb19-243" aria-hidden="true" tabindex="-1"></a>ax3.view_init(elev<span class="op">=</span><span class="dv">10</span>, azim<span class="op">=</span> <span class="dv">30</span>)</span>
<span id="cb19-244"><a href="#cb19-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-245"><a href="#cb19-245" aria-hidden="true" tabindex="-1"></a><span class="co">## labellisation des axes</span></span>
<span id="cb19-246"><a href="#cb19-246" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Proies $x$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-247"><a href="#cb19-247" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Prédateurs $y$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-248"><a href="#cb19-248" aria-hidden="true" tabindex="-1"></a>ax3.set_zlabel(<span class="st">'Intégrale première'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-249"><a href="#cb19-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-250"><a href="#cb19-250" aria-hidden="true" tabindex="-1"></a>ax3.set_yticklabels([])</span>
<span id="cb19-251"><a href="#cb19-251" aria-hidden="true" tabindex="-1"></a>ax3.set_xticklabels([])</span>
<span id="cb19-252"><a href="#cb19-252" aria-hidden="true" tabindex="-1"></a>ax3.set_zticklabels([])</span>
<span id="cb19-253"><a href="#cb19-253" aria-hidden="true" tabindex="-1"></a>fig3.suptitle(<span class="st">"Intégrale première</span><span class="ch">\n</span><span class="st"> modèle de Lotka Volterra"</span>, </span>
<span id="cb19-254"><a href="#cb19-254" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)<span class="op">;</span></span>
<span id="cb19-255"><a href="#cb19-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-256"><a href="#cb19-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-257"><a href="#cb19-257" aria-hidden="true" tabindex="-1"></a>On rajoute la trajectoire et la valeur $H(x,y) = H(x_0, y_0)$ :</span>
<span id="cb19-258"><a href="#cb19-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-261"><a href="#cb19-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-262"><a href="#cb19-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-int-prem-full</span></span>
<span id="cb19-263"><a href="#cb19-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: intégrale première du modèle proies prédateurs de Lotka Volterra (@eq-lovo)</span></span>
<span id="cb19-264"><a href="#cb19-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-265"><a href="#cb19-265" aria-hidden="true" tabindex="-1"></a><span class="co">## H(x,y) = H(x0,y0)</span></span>
<span id="cb19-266"><a href="#cb19-266" aria-hidden="true" tabindex="-1"></a>ax3.plot_surface(X, Y, </span>
<span id="cb19-267"><a href="#cb19-267" aria-hidden="true" tabindex="-1"></a>                np.ones_like(X)<span class="op">*</span>int_premiere([x0, y0], params_LV), </span>
<span id="cb19-268"><a href="#cb19-268" aria-hidden="true" tabindex="-1"></a>                antialiased<span class="op">=</span><span class="va">True</span>, alpha <span class="op">=</span><span class="fl">.3</span>)</span>
<span id="cb19-269"><a href="#cb19-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-270"><a href="#cb19-270" aria-hidden="true" tabindex="-1"></a><span class="co">## trajectoire</span></span>
<span id="cb19-271"><a href="#cb19-271" aria-hidden="true" tabindex="-1"></a>ax3.plot(int_LV[:,<span class="dv">0</span>], int_LV[:,<span class="dv">1</span>], </span>
<span id="cb19-272"><a href="#cb19-272" aria-hidden="true" tabindex="-1"></a>         int_premiere([int_LV[:,<span class="dv">0</span>], int_LV[:,<span class="dv">1</span>]], params_LV), </span>
<span id="cb19-273"><a href="#cb19-273" aria-hidden="true" tabindex="-1"></a>         color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb19-274"><a href="#cb19-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-275"><a href="#cb19-275" aria-hidden="true" tabindex="-1"></a>display(fig3)</span>
<span id="cb19-276"><a href="#cb19-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-277"><a href="#cb19-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-278"><a href="#cb19-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-279"><a href="#cb19-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## Le modèle de Rosenzweig MacArthur {#sec-rma}</span></span>
<span id="cb19-280"><a href="#cb19-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-281"><a href="#cb19-281" aria-hidden="true" tabindex="-1"></a>Nous considérons le modèle de dynamique de populations attribué à Rosenzweig et MacArthur (voir @Rosenzweig1963, @Turchin2003, @Smith2008).</span>
<span id="cb19-282"><a href="#cb19-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-283"><a href="#cb19-283" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb19-284"><a href="#cb19-284" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb19-285"><a href="#cb19-285" aria-hidden="true" tabindex="-1"></a>\dot x = \displaystyle rx\left(1-\frac{x}{K}\right) - c \frac{x}{h+x} y<span class="sc">\\</span><span class="co">[</span><span class="ot">.3cm</span><span class="co">]</span></span>
<span id="cb19-286"><a href="#cb19-286" aria-hidden="true" tabindex="-1"></a>\dot y = b\displaystyle \frac{x}{h+x} y - m y</span>
<span id="cb19-287"><a href="#cb19-287" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb19-288"><a href="#cb19-288" aria-hidden="true" tabindex="-1"></a>$$ {#eq-rma}</span>
<span id="cb19-289"><a href="#cb19-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-290"><a href="#cb19-290" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dynamiques et plan de phase</span></span>
<span id="cb19-291"><a href="#cb19-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-292"><a href="#cb19-292" aria-hidden="true" tabindex="-1"></a>Il n'y a pas de difficulté particulière à la simulation par rapport au modèle de Lotka Volterra.</span>
<span id="cb19-293"><a href="#cb19-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-296"><a href="#cb19-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-297"><a href="#cb19-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-298"><a href="#cb19-298" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>reset <span class="op">-</span>f</span>
<span id="cb19-299"><a href="#cb19-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-300"><a href="#cb19-300" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-301"><a href="#cb19-301" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-302"><a href="#cb19-302" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb19-303"><a href="#cb19-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-304"><a href="#cb19-304" aria-hidden="true" tabindex="-1"></a><span class="co">## densités initiales des populations</span></span>
<span id="cb19-305"><a href="#cb19-305" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb19-306"><a href="#cb19-306" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb19-307"><a href="#cb19-307" aria-hidden="true" tabindex="-1"></a>etat0_RMA <span class="op">=</span> np.array([x0, y0])</span>
<span id="cb19-308"><a href="#cb19-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-309"><a href="#cb19-309" aria-hidden="true" tabindex="-1"></a><span class="co">## tspan </span></span>
<span id="cb19-310"><a href="#cb19-310" aria-hidden="true" tabindex="-1"></a>t_0 <span class="op">=</span> <span class="dv">0</span>             </span>
<span id="cb19-311"><a href="#cb19-311" aria-hidden="true" tabindex="-1"></a>t_fin <span class="op">=</span> <span class="fl">80.0</span>        </span>
<span id="cb19-312"><a href="#cb19-312" aria-hidden="true" tabindex="-1"></a>pas_t <span class="op">=</span> <span class="fl">0.01</span>         </span>
<span id="cb19-313"><a href="#cb19-313" aria-hidden="true" tabindex="-1"></a>tspan <span class="op">=</span> np.arange(t_0, t_fin, pas_t)</span>
<span id="cb19-314"><a href="#cb19-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-315"><a href="#cb19-315" aria-hidden="true" tabindex="-1"></a><span class="co">## paramètres (il y a un cycle limite attractif pour ces valeurs)</span></span>
<span id="cb19-316"><a href="#cb19-316" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb19-317"><a href="#cb19-317" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb19-318"><a href="#cb19-318" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb19-319"><a href="#cb19-319" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="fl">2.0</span></span>
<span id="cb19-320"><a href="#cb19-320" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">2.0</span></span>
<span id="cb19-321"><a href="#cb19-321" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb19-322"><a href="#cb19-322" aria-hidden="true" tabindex="-1"></a>params_RMA <span class="op">=</span> np.array([r, K, c, h, b, m])</span>
<span id="cb19-323"><a href="#cb19-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-324"><a href="#cb19-324" aria-hidden="true" tabindex="-1"></a><span class="co">## modèle </span></span>
<span id="cb19-325"><a href="#cb19-325" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_RMA(etat, t, params):</span>
<span id="cb19-326"><a href="#cb19-326" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat                               </span>
<span id="cb19-327"><a href="#cb19-327" aria-hidden="true" tabindex="-1"></a>    r, K, c, h, b, m <span class="op">=</span> params               </span>
<span id="cb19-328"><a href="#cb19-328" aria-hidden="true" tabindex="-1"></a>    etatdot <span class="op">=</span> [r<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>K) <span class="op">-</span> c<span class="op">*</span>x<span class="op">/</span>(h<span class="op">+</span>x)<span class="op">*</span>y,   </span>
<span id="cb19-329"><a href="#cb19-329" aria-hidden="true" tabindex="-1"></a>               b<span class="op">*</span>x<span class="op">/</span>(h<span class="op">+</span>x)<span class="op">*</span>y <span class="op">-</span> m<span class="op">*</span>y]       </span>
<span id="cb19-330"><a href="#cb19-330" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> etatdot                     </span>
<span id="cb19-331"><a href="#cb19-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-332"><a href="#cb19-332" aria-hidden="true" tabindex="-1"></a><span class="co">## simulation </span></span>
<span id="cb19-333"><a href="#cb19-333" aria-hidden="true" tabindex="-1"></a>int_RMA <span class="op">=</span> odeint(model_RMA, etat0_RMA, tspan, args<span class="op">=</span>(params_RMA,), hmax<span class="op">=</span>pas_t)</span>
<span id="cb19-334"><a href="#cb19-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-335"><a href="#cb19-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-336"><a href="#cb19-336" aria-hidden="true" tabindex="-1"></a>Représentation graphique des trajectoires contre le temps :</span>
<span id="cb19-337"><a href="#cb19-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-340"><a href="#cb19-340" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-341"><a href="#cb19-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-342"><a href="#cb19-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rma-temps</span></span>
<span id="cb19-343"><a href="#cb19-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: simulation des trajectoires du modèle de Rosenzweig et MacArthur (@eq-rma)</span></span>
<span id="cb19-344"><a href="#cb19-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-345"><a href="#cb19-345" aria-hidden="true" tabindex="-1"></a>fig1, ax1 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb19-346"><a href="#cb19-346" aria-hidden="true" tabindex="-1"></a>fig1.suptitle(<span class="st">"Dynamiques du modèle de Rosenzweig - MacArthur"</span>, </span>
<span id="cb19-347"><a href="#cb19-347" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb19-348"><a href="#cb19-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-349"><a href="#cb19-349" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé de x et y contre le temps</span></span>
<span id="cb19-350"><a href="#cb19-350" aria-hidden="true" tabindex="-1"></a>ax1.plot(tspan, int_RMA[:, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"proies $x$"</span>)</span>
<span id="cb19-351"><a href="#cb19-351" aria-hidden="true" tabindex="-1"></a>ax1.plot(tspan, int_RMA[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"prédateurs $y$"</span>)</span>
<span id="cb19-352"><a href="#cb19-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-353"><a href="#cb19-353" aria-hidden="true" tabindex="-1"></a><span class="co">## enluminures</span></span>
<span id="cb19-354"><a href="#cb19-354" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'temps'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-355"><a href="#cb19-355" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'densités de populations'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-356"><a href="#cb19-356" aria-hidden="true" tabindex="-1"></a>ax1.legend(fontsize<span class="op">=</span><span class="st">'10'</span>)</span>
<span id="cb19-357"><a href="#cb19-357" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb19-358"><a href="#cb19-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-359"><a href="#cb19-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-360"><a href="#cb19-360" aria-hidden="true" tabindex="-1"></a>Représentation graphique dans le plan de phase :</span>
<span id="cb19-361"><a href="#cb19-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-364"><a href="#cb19-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-365"><a href="#cb19-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-366"><a href="#cb19-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rma-plane</span></span>
<span id="cb19-367"><a href="#cb19-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: plan de phase du modèle de Rosenzweig et MacArthur (@eq-rma)</span></span>
<span id="cb19-368"><a href="#cb19-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-369"><a href="#cb19-369" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb19-370"><a href="#cb19-370" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">"Plan de phase du modèle de Rosenzweig - MacArthur"</span>, </span>
<span id="cb19-371"><a href="#cb19-371" aria-hidden="true" tabindex="-1"></a>                va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb19-372"><a href="#cb19-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-373"><a href="#cb19-373" aria-hidden="true" tabindex="-1"></a><span class="co">## calcul des isoclines nulles</span></span>
<span id="cb19-374"><a href="#cb19-374" aria-hidden="true" tabindex="-1"></a>xplot <span class="op">=</span> np.arange(<span class="dv">0</span>, K<span class="op">+</span><span class="fl">.1</span>, <span class="fl">.1</span>)  </span>
<span id="cb19-375"><a href="#cb19-375" aria-hidden="true" tabindex="-1"></a>yplot <span class="op">=</span> np.arange(<span class="dv">0</span>, K<span class="op">+</span><span class="fl">.1</span>, <span class="fl">.1</span>)</span>
<span id="cb19-376"><a href="#cb19-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-377"><a href="#cb19-377" aria-hidden="true" tabindex="-1"></a>null_x_x <span class="op">=</span> np.zeros_like(yplot)        </span>
<span id="cb19-378"><a href="#cb19-378" aria-hidden="true" tabindex="-1"></a>null_x_y <span class="op">=</span> r<span class="op">/</span>c<span class="op">*</span>(h<span class="op">+</span>xplot)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>xplot<span class="op">/</span>K)   </span>
<span id="cb19-379"><a href="#cb19-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-380"><a href="#cb19-380" aria-hidden="true" tabindex="-1"></a>null_y_y <span class="op">=</span> np.zeros_like(xplot)        </span>
<span id="cb19-381"><a href="#cb19-381" aria-hidden="true" tabindex="-1"></a>null_y_x <span class="op">=</span> np.ones_like(yplot)<span class="op">*</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)</span>
<span id="cb19-382"><a href="#cb19-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-383"><a href="#cb19-383" aria-hidden="true" tabindex="-1"></a><span class="co">## équilibres</span></span>
<span id="cb19-384"><a href="#cb19-384" aria-hidden="true" tabindex="-1"></a>eq_extinct <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb19-385"><a href="#cb19-385" aria-hidden="true" tabindex="-1"></a>eq_coex <span class="op">=</span> [m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m), r<span class="op">/</span>c<span class="op">*</span>(h<span class="op">+</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m))<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">/</span>K)]</span>
<span id="cb19-386"><a href="#cb19-386" aria-hidden="true" tabindex="-1"></a>eq_prey <span class="op">=</span> [K, <span class="dv">0</span>]</span>
<span id="cb19-387"><a href="#cb19-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-388"><a href="#cb19-388" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé des isoclines nulles, des équilibres, et de la trajectoire simulée</span></span>
<span id="cb19-389"><a href="#cb19-389" aria-hidden="true" tabindex="-1"></a>ax2.plot(null_x_x, yplot, color <span class="op">=</span> <span class="st">'C2'</span>)</span>
<span id="cb19-390"><a href="#cb19-390" aria-hidden="true" tabindex="-1"></a>ax2.plot(xplot, null_x_y, color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">"isoclines nulles de $\dot x$"</span>)</span>
<span id="cb19-391"><a href="#cb19-391" aria-hidden="true" tabindex="-1"></a>ax2.plot(xplot, null_y_y, color <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb19-392"><a href="#cb19-392" aria-hidden="true" tabindex="-1"></a>ax2.plot(null_y_x, yplot, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"isoclines nulles de $\dot y$"</span>)</span>
<span id="cb19-393"><a href="#cb19-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-394"><a href="#cb19-394" aria-hidden="true" tabindex="-1"></a><span class="co">## équilibres</span></span>
<span id="cb19-395"><a href="#cb19-395" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_extinct[<span class="dv">0</span>], eq_extinct[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C3'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb19-396"><a href="#cb19-396" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_coex[<span class="dv">0</span>], eq_coex[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C3'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb19-397"><a href="#cb19-397" aria-hidden="true" tabindex="-1"></a>ax2.plot(eq_prey[<span class="dv">0</span>], eq_prey[<span class="dv">1</span>], marker <span class="op">=</span><span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C3'</span>, markersize <span class="op">=</span> <span class="dv">16</span>)</span>
<span id="cb19-398"><a href="#cb19-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-399"><a href="#cb19-399" aria-hidden="true" tabindex="-1"></a><span class="co">## trajectoires</span></span>
<span id="cb19-400"><a href="#cb19-400" aria-hidden="true" tabindex="-1"></a>ax2.plot(int_RMA[:, <span class="dv">0</span>], int_RMA[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"trajectoire"</span>)</span>
<span id="cb19-401"><a href="#cb19-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-402"><a href="#cb19-402" aria-hidden="true" tabindex="-1"></a><span class="co">## enluminures</span></span>
<span id="cb19-403"><a href="#cb19-403" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Proies $x$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-404"><a href="#cb19-404" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Prédateurs $y$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-405"><a href="#cb19-405" aria-hidden="true" tabindex="-1"></a>ax2.legend(fontsize<span class="op">=</span><span class="st">'10'</span>, loc <span class="op">=</span> <span class="st">"upper right"</span>)</span>
<span id="cb19-406"><a href="#cb19-406" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(bottom<span class="op">=-</span><span class="dv">2</span>, top<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb19-407"><a href="#cb19-407" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left<span class="op">=-</span><span class="dv">2</span>, right<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb19-408"><a href="#cb19-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-409"><a href="#cb19-409" aria-hidden="true" tabindex="-1"></a><span class="co">## représentation du champs de vecteurs</span></span>
<span id="cb19-410"><a href="#cb19-410" aria-hidden="true" tabindex="-1"></a>x_grid <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, K, <span class="dv">10</span>)   </span>
<span id="cb19-411"><a href="#cb19-411" aria-hidden="true" tabindex="-1"></a>y_grid <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, K, <span class="dv">10</span>)</span>
<span id="cb19-412"><a href="#cb19-412" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x_grid, y_grid)</span>
<span id="cb19-413"><a href="#cb19-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-414"><a href="#cb19-414" aria-hidden="true" tabindex="-1"></a><span class="co">## dérivées dot_x et dot_y sur la grille</span></span>
<span id="cb19-415"><a href="#cb19-415" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> model_RMA([X, Y], <span class="dv">0</span>, params_RMA)</span>
<span id="cb19-416"><a href="#cb19-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-417"><a href="#cb19-417" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, width <span class="op">=</span> <span class="fl">.002</span>)<span class="op">;</span></span>
<span id="cb19-418"><a href="#cb19-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-419"><a href="#cb19-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-420"><a href="#cb19-420" aria-hidden="true" tabindex="-1"></a><span class="fu">### Diagramme de bifurcations </span></span>
<span id="cb19-421"><a href="#cb19-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-422"><a href="#cb19-422" aria-hidden="true" tabindex="-1"></a>Nous allons représenter les asymptotiques de la population de prédateurs $y^*$ en fonction de $K$. Il y a 3 situations asymptotiques distinctes pour le modèle de Rosenzweig MacArthur :</span>
<span id="cb19-423"><a href="#cb19-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-424"><a href="#cb19-424" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>si : $0&lt;K&lt;\displaystyle\frac{mh}{b-m}$ : les prédateurs s'éteignent et les proies convergent vers $K$, l'équilibre d'extinction des deux populations est instable.</span>
<span id="cb19-425"><a href="#cb19-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-426"><a href="#cb19-426" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>si : $\displaystyle\frac{mh}{b-m} &lt;K&lt; h+\frac{2mh}{b-m}$ : proies et prédateurs co-existent à un équilibre globalement asymptotiquement stable, l'équilibre d'extinction des prédateurs est instable, l'équilibre d'extinction des deux populations est instable.</span>
<span id="cb19-427"><a href="#cb19-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-428"><a href="#cb19-428" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>si : $h+\displaystyle\frac{2mh}{b-m}&lt;K$ proies et prédateurs co-existent le long d'un cycle limite globalement asymptotiquement stable, l'équilibre d'extinction des prédateurs est instable, l'équilibre d'extinction des deux populations est instable.</span>
<span id="cb19-429"><a href="#cb19-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-430"><a href="#cb19-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-431"><a href="#cb19-431" aria-hidden="true" tabindex="-1"></a>Dans un premier temps nous allons calculer et représenter les différents équilibres et leur stabilité dans le plan $(K, y)$, puis nous calculerons et rajouterons une représentation du cycle limite.</span>
<span id="cb19-432"><a href="#cb19-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-433"><a href="#cb19-433" aria-hidden="true" tabindex="-1"></a>Commençons par les équilibres :</span>
<span id="cb19-436"><a href="#cb19-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-437"><a href="#cb19-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-438"><a href="#cb19-438" aria-hidden="true" tabindex="-1"></a>pas_K <span class="op">=</span> <span class="fl">.1</span></span>
<span id="cb19-439"><a href="#cb19-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-440"><a href="#cb19-440" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 1. </span></span>
<span id="cb19-441"><a href="#cb19-441" aria-hidden="true" tabindex="-1"></a>Kplot1 <span class="op">=</span> np.arange(pas_K, m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">+</span>pas_K, pas_K) </span>
<span id="cb19-442"><a href="#cb19-442" aria-hidden="true" tabindex="-1"></a>y_prey1 <span class="op">=</span> np.zeros_like(Kplot1)                    </span>
<span id="cb19-443"><a href="#cb19-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-444"><a href="#cb19-444" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 2.</span></span>
<span id="cb19-445"><a href="#cb19-445" aria-hidden="true" tabindex="-1"></a>Kplot2 <span class="op">=</span> np.arange(m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m), h<span class="op">+</span><span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">+</span>pas_K, pas_K)</span>
<span id="cb19-446"><a href="#cb19-446" aria-hidden="true" tabindex="-1"></a>y_prey2 <span class="op">=</span> np.zeros_like(Kplot2)                    </span>
<span id="cb19-447"><a href="#cb19-447" aria-hidden="true" tabindex="-1"></a>y_coex2 <span class="op">=</span> [r<span class="op">/</span>c<span class="op">*</span>(h<span class="op">+</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m))<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">/</span>K_p) <span class="cf">for</span> K_p <span class="kw">in</span> Kplot2]</span>
<span id="cb19-448"><a href="#cb19-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-449"><a href="#cb19-449" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 3.</span></span>
<span id="cb19-450"><a href="#cb19-450" aria-hidden="true" tabindex="-1"></a>Kplot3 <span class="op">=</span> np.arange(h<span class="op">+</span><span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m), <span class="dv">8</span>, pas_K<span class="op">/</span><span class="dv">2</span>)      </span>
<span id="cb19-451"><a href="#cb19-451" aria-hidden="true" tabindex="-1"></a>y_prey3 <span class="op">=</span> np.zeros_like(Kplot3)                    </span>
<span id="cb19-452"><a href="#cb19-452" aria-hidden="true" tabindex="-1"></a>y_coex3 <span class="op">=</span> [r<span class="op">/</span>c<span class="op">*</span>(h<span class="op">+</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m))<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>m<span class="op">*</span>h<span class="op">/</span>(b<span class="op">-</span>m)<span class="op">/</span>K_p) <span class="cf">for</span> K_p <span class="kw">in</span> Kplot3]</span>
<span id="cb19-453"><a href="#cb19-453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-454"><a href="#cb19-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-455"><a href="#cb19-455" aria-hidden="true" tabindex="-1"></a>Représentation graphique :</span>
<span id="cb19-458"><a href="#cb19-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-459"><a href="#cb19-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb19-460"><a href="#cb19-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bif-rma</span></span>
<span id="cb19-461"><a href="#cb19-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: diagramme de bifurcation $y^*$ en fonction de $K$ pour le modèle de Rosenzweig MacArthur (@eq-rma)</span></span>
<span id="cb19-462"><a href="#cb19-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-463"><a href="#cb19-463" aria-hidden="true" tabindex="-1"></a>fig3, ax3 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)  </span>
<span id="cb19-464"><a href="#cb19-464" aria-hidden="true" tabindex="-1"></a>fig3.suptitle(<span class="st">"Diagramme de bifurcations $y^*$ en fonction de $K$"</span>,</span>
<span id="cb19-465"><a href="#cb19-465" aria-hidden="true" tabindex="-1"></a>             va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="st">'14'</span>)</span>
<span id="cb19-466"><a href="#cb19-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-467"><a href="#cb19-467" aria-hidden="true" tabindex="-1"></a><span class="co">## tracé des différentes branches d'équilibres</span></span>
<span id="cb19-468"><a href="#cb19-468" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 1.</span></span>
<span id="cb19-469"><a href="#cb19-469" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot1, y_prey1, color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">"équilibre stable"</span>)</span>
<span id="cb19-470"><a href="#cb19-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-471"><a href="#cb19-471" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 2.</span></span>
<span id="cb19-472"><a href="#cb19-472" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot2, y_prey2, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">"équilibre instable"</span>)</span>
<span id="cb19-473"><a href="#cb19-473" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot2, y_coex2, color <span class="op">=</span> <span class="st">'C2'</span>)</span>
<span id="cb19-474"><a href="#cb19-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-475"><a href="#cb19-475" aria-hidden="true" tabindex="-1"></a><span class="co">## situation 3.</span></span>
<span id="cb19-476"><a href="#cb19-476" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot3, y_prey3, color <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb19-477"><a href="#cb19-477" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot3, y_coex3, color <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb19-478"><a href="#cb19-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-479"><a href="#cb19-479" aria-hidden="true" tabindex="-1"></a><span class="co">## enluminures</span></span>
<span id="cb19-480"><a href="#cb19-480" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'densité de prédateurs $y_\infty$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-481"><a href="#cb19-481" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'capacité de charge $K$'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-482"><a href="#cb19-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-483"><a href="#cb19-483" aria-hidden="true" tabindex="-1"></a><span class="co">## Type des bifurcations</span></span>
<span id="cb19-484"><a href="#cb19-484" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">2.2</span>, <span class="fl">0.1</span>, <span class="st">'transcritique'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-485"><a href="#cb19-485" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">5.15</span>, <span class="fl">2.75</span>, <span class="st">'Hopf'</span>, fontsize<span class="op">=</span><span class="st">'12'</span>)</span>
<span id="cb19-486"><a href="#cb19-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-487"><a href="#cb19-487" aria-hidden="true" tabindex="-1"></a>ax3.grid()</span>
<span id="cb19-488"><a href="#cb19-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-489"><a href="#cb19-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-490"><a href="#cb19-490" aria-hidden="true" tabindex="-1"></a>On aimerait pouvoir visualiser sur le diagramme de bifurcations l'amplitude du cycle limite attractif qui émerge de l'équilibre instable. Pour cela, on utilise une approche qui consiste à simuler pendant longtemps le système dynamique et récupérer les extrema de la trajectoire périodique pour ensuite les tracer (approche "brute force").</span>
<span id="cb19-491"><a href="#cb19-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-494"><a href="#cb19-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-495"><a href="#cb19-495" aria-hidden="true" tabindex="-1"></a><span class="co">## temps d'intégration du transitoire "long"</span></span>
<span id="cb19-496"><a href="#cb19-496" aria-hidden="true" tabindex="-1"></a>tspan_transitoire <span class="op">=</span> np.arange(t_0, <span class="dv">100</span><span class="op">*</span>t_fin, pas_t)</span>
<span id="cb19-497"><a href="#cb19-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-498"><a href="#cb19-498" aria-hidden="true" tabindex="-1"></a><span class="co">## array pour sauvegarder les extrema de la trajectoire périodique</span></span>
<span id="cb19-499"><a href="#cb19-499" aria-hidden="true" tabindex="-1"></a>y_cycle_min <span class="op">=</span> np.array([])</span>
<span id="cb19-500"><a href="#cb19-500" aria-hidden="true" tabindex="-1"></a>y_cycle_max <span class="op">=</span> np.array([])</span>
<span id="cb19-501"><a href="#cb19-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-502"><a href="#cb19-502" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> K_p <span class="kw">in</span> Kplot3:</span>
<span id="cb19-503"><a href="#cb19-503" aria-hidden="true" tabindex="-1"></a>    <span class="co">## on assigne le paramètre K à la valeur K_p</span></span>
<span id="cb19-504"><a href="#cb19-504" aria-hidden="true" tabindex="-1"></a>    params_RMA_cycle <span class="op">=</span> np.array([r, K_p, c, h, b, m])</span>
<span id="cb19-505"><a href="#cb19-505" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-506"><a href="#cb19-506" aria-hidden="true" tabindex="-1"></a>    <span class="co">## on simule le système pendant le transitoire</span></span>
<span id="cb19-507"><a href="#cb19-507" aria-hidden="true" tabindex="-1"></a>    int_RMA_transitoire <span class="op">=</span>  odeint(model_RMA, </span>
<span id="cb19-508"><a href="#cb19-508" aria-hidden="true" tabindex="-1"></a>            etat0_RMA, tspan_transitoire, args<span class="op">=</span>(params_RMA_cycle,), </span>
<span id="cb19-509"><a href="#cb19-509" aria-hidden="true" tabindex="-1"></a>            hmax<span class="op">=</span>pas_t)</span>
<span id="cb19-510"><a href="#cb19-510" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-511"><a href="#cb19-511" aria-hidden="true" tabindex="-1"></a>    <span class="co">## on resimule depuis la dernière valeur calculée </span></span>
<span id="cb19-512"><a href="#cb19-512" aria-hidden="true" tabindex="-1"></a>    <span class="co">## dans la simulation du transitoire</span></span>
<span id="cb19-513"><a href="#cb19-513" aria-hidden="true" tabindex="-1"></a>    int_RMA_cycle <span class="op">=</span> odeint(model_RMA, int_RMA_transitoire[<span class="op">-</span><span class="dv">1</span>, :], </span>
<span id="cb19-514"><a href="#cb19-514" aria-hidden="true" tabindex="-1"></a>            tspan, args<span class="op">=</span>(params_RMA_cycle,), hmax<span class="op">=</span>pas_t)</span>
<span id="cb19-515"><a href="#cb19-515" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-516"><a href="#cb19-516" aria-hidden="true" tabindex="-1"></a>    <span class="co">## on sauvegarde les extremas dans y_cycle_min et </span></span>
<span id="cb19-517"><a href="#cb19-517" aria-hidden="true" tabindex="-1"></a>    <span class="co">## _max en appendant les array et les réassignant</span></span>
<span id="cb19-518"><a href="#cb19-518" aria-hidden="true" tabindex="-1"></a>    y_cycle_min <span class="op">=</span> np.append(y_cycle_min, np.<span class="bu">min</span>(int_RMA_cycle[:,<span class="dv">1</span>]))</span>
<span id="cb19-519"><a href="#cb19-519" aria-hidden="true" tabindex="-1"></a>    y_cycle_max <span class="op">=</span> np.append(y_cycle_max, np.<span class="bu">max</span>(int_RMA_cycle[:,<span class="dv">1</span>]))</span>
<span id="cb19-520"><a href="#cb19-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-521"><a href="#cb19-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-522"><a href="#cb19-522" aria-hidden="true" tabindex="-1"></a>Il ne reste plus qu'à tracer ces branches correspondant au cycle limite.</span>
<span id="cb19-523"><a href="#cb19-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-526"><a href="#cb19-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb19-527"><a href="#cb19-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bif-rma-full</span></span>
<span id="cb19-528"><a href="#cb19-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: diagramme de bifurcation $y^*$ en fonction de $K$ pour le modèle de Rosenzweig MacArthur (@eq-rma)</span></span>
<span id="cb19-529"><a href="#cb19-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-530"><a href="#cb19-530" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot3, y_cycle_min, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">"cycle limite attractif"</span>)</span>
<span id="cb19-531"><a href="#cb19-531" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kplot3, y_cycle_max, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb19-532"><a href="#cb19-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-533"><a href="#cb19-533" aria-hidden="true" tabindex="-1"></a><span class="co">## légende</span></span>
<span id="cb19-534"><a href="#cb19-534" aria-hidden="true" tabindex="-1"></a>ax3.legend(fontsize<span class="op">=</span><span class="st">'10'</span>)</span>
<span id="cb19-535"><a href="#cb19-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-536"><a href="#cb19-536" aria-hidden="true" tabindex="-1"></a><span class="co">## réafficher la figure</span></span>
<span id="cb19-537"><a href="#cb19-537" aria-hidden="true" tabindex="-1"></a>display(fig3)</span>
<span id="cb19-538"><a href="#cb19-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-539"><a href="#cb19-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-540"><a href="#cb19-540" aria-hidden="true" tabindex="-1"></a>That's all folks!</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2023, Ludovic Mailleret</div>
  </div>
</footer>



</body></html>